<!DOCTYPE html>
<html lang="en">
<!-- ===================================================================
Manual of SIARD Suite in English: Chapter Invocation.
Application: SIARD Suite 2.1
Platform   : HTML5
========================================================================
Copyright  : Swiss Federal Archives, Berne, Switzerland, 2017
==================================================================== -->
  <head>
    <title>SIARD Suite - Invocation</title>
    <!-- character set -->
    <meta charset="utf-8" />
    <!-- Icon -->
    <link rel="icon" type="image/gif" href="../icon.gif" />
    <!-- Global style sheet -->
    <link rel="stylesheet" href="../assets/css/admin.css">
    <link rel="stylesheet" href="../assets/css/print.css">
    <link rel="stylesheet" href="../siard.css" />
    <!-- Global script collection -->
    <script type="text/javascript" src="../siard.js" ></script>
  </head>
  <body>

    <div class="container container-main">
      <header>
        <div class="clearfix">
          <section class="nav-services clearfix">
            <h2 class="sr-only">Language selection</h2>
            <nav class="nav-lang">
              <ul>
                <li><a href="../de/invocation.html" lang="de" title="Deutsch" aria-label="Deutsch">DE</a></li>
                <li><a href="../fr/invocation.html" lang="fr" title="Français" aria-label="Français">FR</a></li>
                <li><a href="../it/invocation.html" lang="it" title="Italiano" aria-label="Italiano">IT</a></li>
                <li><a lang="en" title="English selected" aria-label="English selected" class="active">EN</a></li>
              </ul>
            </nav>
          </section>
        </div>
          
        <div class="clearfix">
          <div class="table-row">
            <span class="header-logo">
              <img src="../assets/img/swiss.svg" onerror="this.onerror=null; this.src='../assets/img/swiss.png'" alt="Confederatio Helvetica" />
            </span>
            <h1 class="header-title">SIARD Suite 2.1 - Manual</h1>
          </div>
        </div>
      </header>
      
      <div class="nav-main navbar" id="main-navigation"></div>
    
      <div class="container-fluid hidden-xs">
        <div class="row">
          <div class="col-sm-12">
            <h2 id="br1" class="hidden">Breadcrumbs</h2>
            <ol class="breadcrumb" role="navigation" aria-labelledby="br1">
              <li><a href="./index.html">SIARD Suite 2.1 - Manual</a><span class="icon icon--greater"></span></li>
              <li class="active" aria-selected="true">Invocation of Command-Line Tools</li>
            </ol>
          </div>
        </div>
      </div>

      <div class="container-fluid">
        <div class="row">
          <div class="col-sm-12 main-column" id="content" role="main">
            <div class="contentHead">
              <div class="mod mod-contentpage">
                <h1>SIARD Suite 2.1 - Invocation of Command-Line Tools</h1>
              </div>
            </div>  
            <div class="mod mod-text">
              <section class="clearfix">
                <p>The download and upload functionality of <em>SIARD Suite</em>
                  can be called from the command line:</p>
                <ul>
                  <li><a href="#siardfromdb"><em>SiardFromDb</em></a>: download of a SIARD archive,</li>
                  <li><a href="#siardtodb"><em>SiardToDb</em></a>: upload of a SIARD archive.</li>
                </ul>
                
                <p class="pull-right">
                  <small>
                    <a href="#" class="icon icon--before icon--power hidden-print">Top of page</a>
                  </small>
                </p>
                
                <h2><a id="siardfromdb">SiardFromDb</a></h2>
                <p><em>SiardFromDb</em> is a command-line program which extracts 
                  a database to a SIARD archive. One can use <em>SiardFromDb</em>
                  to create</p>
                <ul> 
                  <li>a SIARD archive (meta data  and primary data) based on the database (option <em>-s</em>), and/or</li>
                  <li>SIARD meta data XML, containing a definition of the database schema (option <em>-e</em>).</li>
                </ul>
                
                <p class="pull-right">
                  <small>
                    <a href="#" class="icon icon--before icon--power hidden-print">Top of page</a>
                  </small>
                </p>
                
                <h3>Invocation</h3>
                <pre>java -cp &lt;siardpath&gt;/lib/siardcmd.jar ch.admin.bar.siard2.cmd.SiardFromDb [-h] |
  [-o] [-v] [-l=&lt;login timeout&gt;] [-q=&lt;query timeout&gt;] [-i=&lt;import meta data&gt;] [-x=&lt;external lob folder&gt;] [-m=&lt;mime type&gt;]
  -j=&lt;JDBC URL&gt; -u=&lt;database user&gt; -p=&lt;database password&gt; -s=&lt;siard file&gt; -e=&lt;export meta data&gt;"
                </pre>
                <p>Specify  &lt;siardpath&gt; as the folder where <em>SIARD Suite</em> is installed. 
                  The file <em>siardcmd.jar</em> is in the <em>lib</em> subfolder with
                  its class <em>ch.admin.bar.siard2.cmd.SiardFromDb</em>, whose <em>main()</em>
                  is invoked with <em>java</em> (it is better to use <em>javaw</em> under Windows).</p>
                <p>The call syntax is displayed if the <em>-h (help)</em> option is entered
                  on the command line.</p>
                
                <p class="pull-right">
                  <small>
                    <a href="#" class="icon icon--before icon--power hidden-print">Top of page</a>
                  </small>
                </p>
                
                <h3>Arguments</h3>
                <table>
                  <tr><th>Argument</th><th>Meaning</th></tr>
                  <tr><td>-o</td><td>overwrite output file(s) if they exist</td></tr>
                  <tr><td>-v</td><td>archive views as tables</td></tr>
                  <tr><td>&lt;login timeout&gt;</td><td>timeout in seconds for login (0 for unlimited)</td></tr>
                  <tr><td>&lt;query timeout&gt;</td><td>timeout in seconds for query (0 for unlimited)</td></tr>
                  <tr><td>&lt;import meta data&gt;</td><td>name of meta data XML file to be used as a template</td></tr>
                  <tr><td>&lt;external LOB folder&gt;</td><td>folder for storing the data of the largest LOB column of database externally (contents will be deleted if they exist!)</td></tr>
                  <tr><td>&lt;mime type&gt;</td><td>MIME type of data in the largest LOB column of database (influences file extension of externally stored LOBs)</td></tr>
                  <tr><td valign="top">&lt;JDBC URL&gt;</td><td>JDBC URL of database to be downloaded<br/>
                    e.g.
                    <dl>
                      <dt>for <em>MS Access</em></dt>
                        <dd><em>jdbc:access:D:\Projekte\SIARD2\JdbcAccess\testfiles\testdb.mdb</em></dd>
	                    <dt>for <em>DB/2</em></dt>
	                      <dd>jdbc:dbserver.enterag.ch:50000/testdb</dd>
	                    <dt>for <em>H2 database</em></dt>
	                      <dd><em>jdbc:h2:D:/Projekte/SIARD2/JdbcH2/data/testdb</em></dd>
	                    <dt>for <em>MySQL</em></dt>
	                      <dd><em>jdbc:mysql://dbserver.enterag.ch:3306/testdb</em></dd>
	                    <dt>for <em>Oracle</em></dt>
	                      <dd><em>jdbc:oracle:thin:@dbserver.enterag.ch:1521:orcl</em></dd>
	                    <dt>for <em>Postgres</em></dt>
	                      <dd><em>jdbc:postgresql://dbserver.enterag.ch:5432/testdb</em></dd>
	                    <dt>for SQL Server</dt>
	                      <dd><em>jdbc:sqlserver://dbserver.enterag.ch\testdb:1433</em><br/>
	                      (in bash shell the latter must be quoted with duplicated backslash:<br/>
	                      <em>"jdbc:sqlserver://dbserver.enterag.ch\\testdb:1433"</em>)</dd>
                    </dl> 
                  </td></tr>
                  <tr><td>&lt;database user&gt;</td><td>database user</td></tr>
                  <tr><td>&lt;database password&gt;</td><td>database password</td></tr>
                  <tr><td>&lt;siard file&gt;</td><td>name of .siard file to be written</td></tr>
                  <tr><td>&lt;export meta data&gt;</td><td>name of meta data .xml file to be exported</td></tr>
                </table>
                
                <p class="pull-right">
                  <small>
                    <a href="#" class="icon icon--before icon--power hidden-print">Top of page</a>
                  </small>
                </p>
                
                <h3>Notes</h3>
                <p>Either the SIARD file or the export meta data file or both must be given.</p>
                <p>The <em>SiardFromDb</em> program should be used against a database snapshot 
                  which doesn't change during the archiving process.</p>
                <p>The option <em>archive views as tables</em> usually leads to data duplication
                  and is therefore not recommended. However, it is useful when the
                  archival user has read access to the views but not to the base tables.</p>
                <p>The archiving process either wholly succeeds or wholly fails.</p>
                <p>For large databases, it is recommended to download just the meta data XML beforehand. This gives
                  insight into all the meta data and table sizes, which helps to estimate 
                  the download time needed. Furthermore, one should use the <em>-q 0</em> option 
                  for large tables as it is not possible to estimate how many seconds a 
                  size query will take.</p>
                <p>The conversion of TIMEs and TIMESTAMPs in the database depends on the 
                  local time zone. If the time 15:30 is stored in Zurich, the UTC time 
                  value 14:30 will be stored in the SIARD file – in winter. To suppress 
                  this conversion one must start <em>SiardFromDb</em> with the option</p>
                  <pre>-Duser.timezone=GMT</pre>
                <p>which tells SIARD to interpret all database times as UTC times.</p>
                
                <p class="pull-right">
                  <small>
                    <a href="#" class="icon icon--before icon--power hidden-print">Top of page</a>
                  </small>
                </p>
                
                <h3>Archiving Database User</h3>
                <p>It is generally inadvisable to use the database administrator user (DBA,
                  root, dbo, ...) for downloading a SIARD archive. The extent of the SIARD
                  archive is defined by the objects to which the archiving database user
                  has read-access. The global DBA usually has read access to all databases
                  on the system as well as numerous system tables that should not be archived.
                  Therefore it is important that a suitable archiving user be created for
                  the download if one does not exist.</p>
                
                <p class="pull-right">
                  <small>
                    <a href="#" class="icon icon--before icon--power hidden-print">Top of page</a>
                  </small>
                </p>
                
                <h2><a id="siardtodb">SiardToDb</a></h2>
                <p><em>SiardToDb</em> is a command-line program which loads a SIARD archive
                into a database for research purposes.</p>
                
                <p class="pull-right">
                  <small>
                    <a href="#" class="icon icon--before icon--power hidden-print">Haut de page</a>
                  </small>
                </p>

                <h3>Invocation</h3>
                <pre>java -cp &lt;siardpath&gt;/lib/siardcmd.jar ch.admin.bar.siard2.cmd.SiardToDb [-h]
  [-o] [-l=&lt;login timeout&gt;] [-q=&lt;query timeout&gt;]
  -s=&lt;siard file&gt; -j=&lt;JDBC URL&gt; -u=&lt;database user&gt; -p=&lt;database password&gt;
  [&lt;schema&gt; &lt;mappedschema&gt;]*</pre>
                <p>Specify  &lt;siardpath&gt; as the folder where <em>SIARD Suite</em> is installed. 
                  The file <em>siardcmd.jar</em> is in the <em>lib</em> subfolder with
                  its class <em>ch.admin.bar.siard2.cmd.SiardToDb</em>, whose <em>main()</em>
                  should be invoked with <em>java</em> (it is better to use <em>javaw</em> under Windows).</p>
                <p>The call syntax is displayed if the <em>-h (help)</em> option is entered
                  on the command line.</p>
                
                <p class="pull-right">
                  <small>
                    <a href="#" class="icon icon--before icon--power hidden-print">Top of page</a>
                  </small>
                </p>
                
                <h3>Arguments</h3>
                <table>
                  <tr><th>Argument</th><th>Meaning</th></tr>
                  <tr><td>-o</td><td>overwrite types and/or tables in the database if they exist</td></tr>
                  <tr><td>&lt;login timeout&gt;</td><td>timeout in seconds for login (0 for unlimited)</td></tr>
                  <tr><td>&lt;query timeout&gt;</td><td>timeout in seconds for query (0 for unlimited)</td></tr>
                  <tr><td>&lt;siard file&gt;</td><td>name of .siard file to be uploaded</td></tr>
                  <tr><td valign="top">&lt;JDBC URL&gt;</td><td>JDBC URL of the target database<br/>
                    e.g.
                    <dl>
	                    <dt>for <em>MS Access</em></dt>
	                      <dd><em>jdbc:access:D:\Projekte\SIARD2\JdbcAccess\testfiles\testdb.mdb</em></dd>
	                    <dt>for <em>DB/2</em></dt>
	                      <dd><em>jdbc:dbserver.enterag.ch:50000/testdb</em></dd>
	                    <dt>for <em>H2 database</em></dt>
	                      <dd><em>jdbc:h2:D:/Projekte/SIARD2/JdbcH2/data/testdb</em></dd>
	                    <dt>for <em>MySQL</em></dt>
	                      <dd><em>jdbc:mysql://dbserver.enterag.ch:3306/testdb</em></dd>
	                    <dt>for <em>Oracle</em></dt>
	                      <dd><em>jdbc:oracle:thin:@dbserver.enterag.ch:1521:orcl</em></dd>
	                    <dt>for <em>Postgres</em></dt>
	                      <dd><em>jdbc:postgres://dbserver.enterag.ch:5432/testdb</em></dd>
	                    <dt>for <em>SQL Server</em></dt>
	                      <dd><em>jdbc:sqlserver://dbserver.enterag.ch\testdb:1433</em><br/>
	                      (in bash shell the latter must be quoted with duplicated backslash:<br/>
	                      <em>"jdbc:sqlserver://dbserver.enterag.ch\\testdb:1433"</em>)</dd>
                    </dl> 
                  </td></tr>
                  <tr><td>&lt;database user&gt;</td><td>database user</td></tr>
                  <tr><td>&lt;database password&gt;</td><td>database password</td></tr>
                  <tr><td>&lt;schema&gt;</td><td>schema name in SIARD file</td></tr>
                  <tr><td>&lt;mappedschema&gt;</td><td>schema name to be used in database</td></tr>
                </table>
                
                <p class="pull-right">
                  <small>
                    <a href="#" class="icon icon--before icon--power hidden-print">Top of page</a>
                  </small>
                </p>
                
                <h3>Notes</h3>
                <p>As older databases are not SQL:2008 compliant, a considerable amount of 
                  manual configuration effort is unavoidable in preparation for the upload. 
                  There are no Schema objects in MS Access. User and Schema objects are not 
                  separate in Oracle. Schemas and databases are not distinct in MySQL. 
                  Therefore target schemas must be created before upload.
                  Also the database user must have the right to create tables and types
                  in those schemas. Because this is not always easily possible, 
                  SIARD schemas are mapped to database schemas according to the list 
                  of schema mappings on the command line.</p> 
                <p>Uploading only creates tables and types and attempts to enable 
                  unique and foreign key constraints. No other database objects are created. 
                  If the constraints cannot be enabled a warning is issued but the 
                  upload is nevertheless considered to be successful. Even without 
                  constraints SQL SELECT queries can be issued against the database.</p>
                <p>Furthermore, certain sacrifices are made. In MS Access, 
                  all tables end up in the same MDB/ACCDB. In Oracle, all names 
                  longer than 30 characters are abbreviated. To avoid collisions, 
                  table and column names are extended by a counter. (E.g. 
                  "A far too long a table name for Oracle" becomes "A far too long a table name01".)</p>
                <p>Where the maximum precision and the maximum number of decimals 
                  (for instance MS Access) are smaller than required, the values 
                  are uploaded with less precision. SIARD helps as much as is 
                  possible in the target database system. Consulting the database 
                  meta data via <em>SiardGui</em> allows the correct assignment 
                  of designations and values.</p>
                <p>The conversion of TIMEs and TIMESTAMPs in the database depends 
                  on the local time zone. The UTC time 14:30 in the SIARD file 
                  is uploaded in Zurich as the local time 15:30 to the database – in winter. 
                  To suppress this conversion one must start <em>SiardToDb</em> with the option</p>
                  <pre>-Duser.timezone=GMT</pre>
                <p>which tells SIARD to interpret all database times as UTC times.</p>
              </section>
            </div>
        
            <div class="clearfix">
              <p class="pull-right">
                <small>
                  <a href="#" class="icon icon--before icon--power hidden-print">
                    Top of page
                  </a>
                </small>
              </p>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="container-fluid">
          <hr class="footer-line">
          <img src="../assets/img/logo-CH.svg" onerror="this.onerror=null; this.src='../assets/img/logo-CH.png'" />
          <h1 class="hidden-xs">Swiss Federal Archives</h1>
          <p class=pull-right><a href="../../../LICENSE.txt" target="_blank">License</a></p>
        </div>
      </footer>
    </div>
  </body>
</html>
